{"componentChunkName":"component---src-templates-blog-post-js","path":"/aws/ì´ë¯¸ì§€ì—…ë¡œë“œ_ìŠ¬ë™ë´‡/","result":{"data":{"site":{"siteMetadata":{"title":"ì–´ì„œì˜¤ì„¸ìš”, ìƒ¨ë‚Œì˜ ì„œì¬ì…ë‹ˆë‹¤.","author":"Syankkim","siteUrl":"https://syankkim.github.io","comment":{"disqusShortName":"","utterances":"JaeYeopHan/gatsby-starter-bee"},"sponsor":{"buyMeACoffeeId":"ksso7300"}}},"markdownRemark":{"id":"d36f8ac6-d2d1-5963-a1ac-b67872dd8c99","excerpt":"S3 ì´ë¯¸ì§€ ì—…ë¡œë“œ ìŠ¬ë™ë´‡ ë§Œë“¤ê¸° with Lambda S3 bucketìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œ í•  ìˆ˜ ìˆëŠ” ìŠ¬ë™ë´‡ì´ í•„ìš”í•˜ë‹¤ëŠ” ìš”ì²­ì„ ë°›ì•˜ìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê³  ë¹„ê°œë°œì ë¶„ì´ ì´ë¯¸ì§€ íƒœê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìƒì„±í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ í•„ìš”í–ˆì£ . ìŠ¬ë™ë´‡ì„ ì²˜ìŒ ë§Œë“¤ì–´ ë´¤ì§€ë§Œ, í”Œë«í¼ ê°œë°œê³¼ëŠ” ë‹¤ë¥¸ ì¬ë¯¸ê°€ ìˆë”ë¼êµ¬ìš”. ìŠ¬ë™ë´‡ ì™„ì„±ë³¸ ì•„ë˜ ì™„ì„±ë³¸ì„ ë¨¼ì € ë³´ì—¬ë“œë¦½ë‹ˆë‹¤. ì±„ë„ì— ì´ë¯¸ì§€ë¥¼ ì˜¬ë¦¬ë©´ â€œì—…ë¡œë“œ ìš”ì²­ì¤‘ì´ë‹ˆë‹¤. ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!â€ \në¬¸êµ¬ê°€ ìŠ¤ë ˆë“œì— ì°íˆê³  S3 ì— ì´ë¯¸ì§€ ì—…ë¡œë“œë¥¼ ì™„ë£Œ í›„, \nSâ€¦","html":"<h1 id=\"s3-ì´ë¯¸ì§€-ì—…ë¡œë“œ-ìŠ¬ë™ë´‡-ë§Œë“¤ê¸°-with-lambda\" style=\"position:relative;\"><a href=\"#s3-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%97%85%EB%A1%9C%EB%93%9C-%EC%8A%AC%EB%9E%99%EB%B4%87-%EB%A7%8C%EB%93%A4%EA%B8%B0-with-lambda\" aria-label=\"s3 ì´ë¯¸ì§€ ì—…ë¡œë“œ ìŠ¬ë™ë´‡ ë§Œë“¤ê¸° with lambda permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>S3 ì´ë¯¸ì§€ ì—…ë¡œë“œ ìŠ¬ë™ë´‡ ë§Œë“¤ê¸° with Lambda</h1>\n<p>S3 bucketìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œ í•  ìˆ˜ ìˆëŠ” ìŠ¬ë™ë´‡ì´ í•„ìš”í•˜ë‹¤ëŠ” ìš”ì²­ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.</p>\n<p>ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê³  ë¹„ê°œë°œì ë¶„ì´ ì´ë¯¸ì§€ íƒœê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìƒì„±í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ í•„ìš”í–ˆì£ .</p>\n<p>ìŠ¬ë™ë´‡ì„ ì²˜ìŒ ë§Œë“¤ì–´ ë´¤ì§€ë§Œ, í”Œë«í¼ ê°œë°œê³¼ëŠ” ë‹¤ë¥¸ ì¬ë¯¸ê°€ ìˆë”ë¼êµ¬ìš”.</p>\n<h2 id=\"ìŠ¬ë™ë´‡-ì™„ì„±ë³¸\" style=\"position:relative;\"><a href=\"#%EC%8A%AC%EB%9E%99%EB%B4%87-%EC%99%84%EC%84%B1%EB%B3%B8\" aria-label=\"ìŠ¬ë™ë´‡ ì™„ì„±ë³¸ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìŠ¬ë™ë´‡ ì™„ì„±ë³¸</h2>\n<p>ì•„ë˜ ì™„ì„±ë³¸ì„ ë¨¼ì € ë³´ì—¬ë“œë¦½ë‹ˆë‹¤.</p>\n<p>ì±„ë„ì— ì´ë¯¸ì§€ë¥¼ ì˜¬ë¦¬ë©´ â€œì—…ë¡œë“œ ìš”ì²­ì¤‘ì´ë‹ˆë‹¤. ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”!â€ </br>\në¬¸êµ¬ê°€ ìŠ¤ë ˆë“œì— ì°íˆê³  S3 ì— ì´ë¯¸ì§€ ì—…ë¡œë“œë¥¼ ì™„ë£Œ í›„, </br>\nS3ì—…ë¡œë“œ ëœ <strong>ì´ë¯¸ì§€ì˜ uuid cloudfront prefix ì£¼ì†Œ, width, height ì •ë³´ê°€ ë‹´ê¸´ íƒœê·¸ë¥¼ ë‚¨ê²¨ì¤ë‹ˆë‹¤.</strong> </br>\ní•„ìš”ì— ë”°ë¼ ìŠ¬ë™ <code class=\"language-text\">block_actions</code> ì´ë²¤íŠ¸ë¥¼ í†µí•´ ì´ë¯¸ì§€ ë§í¬ì™€ ì„¤ëª… íƒœê·¸ë„ ì¶”ê°€ ê°€ëŠ¥í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤. </br>\nì—¬ëŸ¬ê°œì˜ íŒŒì¼ì„ ì˜¬ë ¤ë„ ë™ì‘í•©ë‹ˆë‹¤.</p>\n<img width=\"600\" alt=\"&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2023-01-24 &#x110B;&#x1169;&#x1112;&#x116E; 6 16 20\" src=\"https://user-images.githubusercontent.com/28856435/214256819-e35ce316-a92d-46e6-8d42-def26e1935fd.png\">\n<hr>\n<p>ë§Œì•½ S3 ì—…ë¡œë“œì— ì„±ê³µí•œ íŒŒì¼ì´ ì—†ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ë³´ì—¬ì¤ë‹ˆë‹¤.\nìì„¸í•œ ì˜¤ë¥˜ëŠ” ë¡œê·¸ë¥¼ ë‚¨ê¸°ë„ë¡ í–ˆì–´ìš”.</p>\n<img width=\"400\" alt=\"&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2023-01-28 &#x110B;&#x1169;&#x1112;&#x116E; 2 34 06\" src=\"https://user-images.githubusercontent.com/98014209/215248037-eaa505f1-25c8-4946-a999-8ad07741434f.png\">\n<h2 id=\"ê³ ë¯¼-ë°°ì› ë˜-ì ë“¤\" style=\"position:relative;\"><a href=\"#%EA%B3%A0%EB%AF%BC-%EB%B0%B0%EC%9B%A0%EB%8D%98-%EC%A0%90%EB%93%A4\" aria-label=\"ê³ ë¯¼ ë°°ì› ë˜ ì ë“¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê³ ë¯¼, ë°°ì› ë˜ ì ë“¤</h2>\n<p>êµ¬í˜„ëœ ë‚´ìš©ì€ ì•„ë˜ì— ìˆì§€ë§Œ, ìŠ¬ë™ë´‡ì„ ì²˜ìŒ ë§Œë“¤ì–´ë³´ë©´ì„œ ë¶€ë”ªí˜”ë˜ ì¼ë“¤ì„ ë¨¼ì € ê¸°ë¡í•´ë‘ë ¤ í•´ìš”.</p>\n<h3 id=\"1-ì´ë¯¸ì§€ë¥¼-ë‹¤ìš´ë°›ê¸°-ìœ„í•œ-url\" style=\"position:relative;\"><a href=\"#1-%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A5%BC-%EB%8B%A4%EC%9A%B4%EB%B0%9B%EA%B8%B0-%EC%9C%84%ED%95%9C-url\" aria-label=\"1 ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë°›ê¸° ìœ„í•œ url permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1) ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ë°›ê¸° ìœ„í•œ url</h3>\n<p>ì•„ë˜ ì½”ë“œë¥¼ ì‚¬ìš©í•´ì„œ ì´ë¯¸ì§€ë¥¼ ë‹¤ìš´ ë°›ì„ ìˆ˜ ìˆëŠ”ë°,</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">urllib<span class=\"token punctuation\">.</span>reqeust<span class=\"token punctuation\">.</span>urlretrieve<span class=\"token punctuation\">(</span><span class=\"token string\">\"ì´ë¯¸ì§€ ì£¼ì†Œ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"ì €ì¥ í•  íŒŒì¼ì´ë¦„\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì´ë¯¸ì§€ ì£¼ì†Œê°€ <span style='color: tomato;'>ë‹¤ìš´ë¡œë“œê°€ ê°€ëŠ¥í•œ ì£¼ì†Œ</span>ê°€ ì•„ë‹ˆë¼ë©´, ìœ„ ì½”ë“œì—ì„œë„ ë™ì‘í•˜ì§€ ì•Šì•˜ì–´ìš”.</br> í•´ë‹¹ url ì„ â€˜public permalinkâ€™ í•„ë“œì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ëŠ” ìˆì—ˆì§€ë§Œ, ë‹¤ìš´ë¡œë“œê°€ ê°€ëŠ¥í•œ ì£¼ì†Œê°€ ì•„ë‹ˆì—ˆì£ . </br>\nğŸ’¡ </br>ê·¸ë˜ì„œ <code class=\"language-text\">request.get(url).content</code> ë¡œ í•´ë‹¹ ë§í¬ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì™€, ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•œ ì£¼ì†Œë¥¼ ì¶”ì¶œí•´ëƒˆìŠµë‹ˆë‹¤. </br></p>\n<hr>\n<h3 id=\"2-ëŒë‹¤ì˜-ì„ì‹œì €ì¥-ìŠ¤í† ë¦¬ì§€\" style=\"position:relative;\"><a href=\"#2-%EB%9E%8C%EB%8B%A4%EC%9D%98-%EC%9E%84%EC%8B%9C%EC%A0%80%EC%9E%A5-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80\" aria-label=\"2 ëŒë‹¤ì˜ ì„ì‹œì €ì¥ ìŠ¤í† ë¦¬ì§€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2) ëŒë‹¤ì˜ ì„ì‹œì €ì¥ ìŠ¤í† ë¦¬ì§€</h3>\n<p>ë¡œì»¬ì—ì„œëŠ” ì›í•˜ëŠ” ë””ë ‰í† ë¦¬ì— ë‹¤ìš´ë°›ì€ ì´ë¯¸ì§€ë¥¼ ì„ì‹œì €ì¥í•  ìˆ˜ ìˆì—ˆì–´ìš”. ê·¸ëŸ°ë°, ëŒë‹¤ì—ì„œëŠ” ì•„ë¬´ ë””ë ‰í† ë¦¬ë‚˜ ìƒì„±í•˜ê±°ë‚˜ ì½ì„ ìˆ˜ ìˆëŠ” ê¶Œí•œì´ ì—†ì–´ì„œ ë˜ ë‹¤ë¥¸ ë¬¸ì œì— ë´‰ì°©í–ˆìŠµë‹ˆë‹¤.</br>\nğŸ’¡ </br>ì•Œê³ ë³´ë‹ˆ, ëŒë‹¤ì—ì„œëŠ” íŒŒì¼ì„ ì½ê±°ë‚˜ ì €ì¥í•  ìˆ˜ ìˆëŠ” ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¡œ <span style='color: tomato;'>/tmp</span> ì˜ì—­ë§Œì„ ì œê³µí•´ì£¼ê³  ìˆì—ˆì–´ìš”.\nì´ ì˜ì—­ì€ ëŒë‹¤ ì‹¤í–‰í™˜ê²½ì˜ ìˆ˜ëª…ë™ì•ˆ ë³´ì¡´ëœë‹¤ê³  í•©ë‹ˆë‹¤.</p>\n<hr>\n<h3 id=\"3-ìŠ¬ë™ì—ì„œì˜-ì¤‘ë³µ-request\" style=\"position:relative;\"><a href=\"#3-%EC%8A%AC%EB%9E%99%EC%97%90%EC%84%9C%EC%9D%98-%EC%A4%91%EB%B3%B5-request\" aria-label=\"3 ìŠ¬ë™ì—ì„œì˜ ì¤‘ë³µ request permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3) ìŠ¬ë™ì—ì„œì˜ ì¤‘ë³µ Request</h3>\n<p>ì´ë¯¸ì§€ë¥¼ ì˜¬ë ¸ìœ¼ë©´, í•œë²ˆì˜ Requestë¡œ ëŒë‹¤ í•¨ìˆ˜ë„ í•œë²ˆë§Œ í˜¸ì¶œë˜ë©´ ë˜ëŠ” ì¼ì¸ë°, ì¤‘ë³µìœ¼ë¡œ 5ë²ˆ ì´ìƒ ìš”ì²­ì´ ê³„ì†í•´ì„œ ë“¤ì–´ì˜¤ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.</p>\n<p>ê·¸ë˜ì„œ ê³µì‹ë¬¸ì„œì—ì„œ ì°¾ì•„ë‚¸ ì‚¬ì‹¤ì€, ì‹¤íŒ¨í•œ ìš”ì²­ì„ ìµœëŒ€ 3ë²ˆ ì¬ìš”ì²­ í•œë‹¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. </br>\n<a href=\"https://api.slack.com/apis/connections/events-api#retries\">Slack Event API: Retries</a> ì´ ë§í¬ë¥¼ ì°¸ê³ í•˜ë©´, ì—¬ëŸ¬ ì‹¤íŒ¨ì›ì¸ì„ ê·œì •í•˜ê³  ìˆëŠ”ë°, ì œê°€ ë°›ì€ ìš”ì²­ ë³¸ë¬¸ì— í¬í•¨ëœ ì›ì¸ì€ <code class=\"language-text\">http_timeout</code> ì´ ëŒ€ë¶€ë¶„ ì´ì—ˆê³ ,\nâ€œYour server took longer than 3 seconds to respond to the previous event delivery attempt.â€ ì´ë ‡ê²Œ ê·œì •í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤. </br>\nì´ë¯¸ì§€ ì—…ë¡œë“œ ëŒë‹¤ í•¨ìˆ˜ëŠ” ê³„ì† 3ì´ˆ ì´ìƒì´ ê±¸ë ¸ë˜ ê²ƒì´ì§€ìš” ğŸ˜‡ ì´ëŸ¬í•œ ì¤‘ë³µ ìš”ì²­ì„ ë§‰ìœ¼ë ¤ë©´ ìš”ì²­ í—¤ë”ì— ì•„ë˜ í•„ë“œë¥¼ í¬í•¨í•´ ì£¼ë©´ ëœë‹¤ê³  ê¸°ì¬ë˜ì–´ ìˆì–´ ì¶”ê°€í•´ì¤¬ì§€ë§Œ, í•´ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ğŸ˜­ (ì•„ë§ˆ, 3ì´ˆì•ˆì— ì‘ë‹µë°›ì§€ ëª»í•´ì„œ ì € í—¤ë”ê°’ë„ ì¸ì‹ë˜ì§€ ì•Šì€ê²ƒì´ ì•„ë‹Œê°€.. ì¶”ì¸¡í•©ë‹ˆë‹¤.)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">X-Slack-No-Retry: 1</code></pre></div>\n<p>ğŸ’¡ </br>\nì¤‘ë³µìœ¼ë¡œ ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ í—¤ë” ê°’ì„ ì˜ ì‚´í´ë³´ë‹ˆ, <code class=\"language-text\">X-Slack-Retry-Num</code> ì´ë¼ëŠ” í•„ë“œë¥¼ ë“¤ê³  ë“¤ì–´ì˜¤ë”ë¼êµ¬ìš”.</br>\nê·¸ë˜ì„œ ê²°êµ­ì—ëŠ” ìš” í•„ë“œê°€ ì—†ì„ ê²½ìš°ì—ë§Œ ì²˜ë¦¬í•˜ë„ë¡ í–ˆë”ë‹ˆ, ì›í•˜ëŠ”ëŒ€ë¡œ ë”± í•œ ë²ˆì˜ ì²« ìš”ì²­ë§Œ ì²˜ë¦¬ë˜ê²Œ í•˜ëŠ”ë° ì„±ê³µí–ˆìŠµë‹ˆë‹¤. ì–´ì¨Œë“  ì‘ë‹µ í—¤ë”ê°’ì— <code class=\"language-text\">X-Slack-No-Retry': 1</code> ë„ ì¶”ê°€í•´ì¤¬ì–´ìš”.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">if</span> req_header<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'X-Slack-Retry-Num'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    logger<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">'The event already processed'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> make_response<span class=\"token punctuation\">(</span><span class=\"token string\">'OK'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'X-Slack-No-Retry'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"êµ¬ì¡°-ì„¤ê³„\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%EC%A1%B0-%EC%84%A4%EA%B3%84\" aria-label=\"êµ¬ì¡° ì„¤ê³„ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>êµ¬ì¡° ì„¤ê³„</h2>\n<p>íŒŒì¼ ì—…ë¡œë“œ ë™ì‘ì„ ìŠ¬ë™ë´‡ì´ ê°ì§€í•˜ì—¬ ìˆ˜í–‰ë˜ëŠ” ë°©ì‹ì´ë©°,\nì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ë‹¤ìŒ ë™ì‘ì„ ê¸°ëŒ€í•˜ê³  ì§„í–‰í–ˆìŠµë‹ˆë‹¤.</p>\n<img width=\"500\" alt=\"&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2023-01-24 &#x110B;&#x1169;&#x1112;&#x116E; 5 54 02\" src=\"https://user-images.githubusercontent.com/28856435/214249254-17009062-5410-4394-99b2-b812134920fd.png\">\n<ol>\n<li>ì±„ë„ì— ì´ë¯¸ì§€ ì—…ë¡œë“œ</li>\n<li>íŒŒì¼ ì—…ë¡œë“œ ê°ì§€, ìŠ¬ë™ ì´ë²¤íŠ¸ API <code class=\"language-text\">Lambda function</code> í˜¸ì¶œ</li>\n<li>ëŒë‹¤ í•¨ìˆ˜ì—ì„œ ì²´í¬ì´ë¯¸ì§€ ë‹¤ìš´ ë° <code class=\"language-text\">S3</code> ì—…ë¡œë”©</li>\n<li>ì—…ë¡œë“œ ì„±ê³µ í›„, ìŠ¬ë™ ì´ë¯¸ì§€ ìŠ¤ë ˆë“œì— ì´ë¯¸ì§€ ì •ë³´ ë‹µë³€</li>\n</ol>\n<h2 id=\"sam-serverless-application-model-with-python\" style=\"position:relative;\"><a href=\"#sam-serverless-application-model-with-python\" aria-label=\"sam serverless application model with python permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[SAM] Serverless Application Model (with python)</h2>\n<p><code class=\"language-text\">SAM</code> ì´ë€, ì„œë²„ë¦¬ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶•ì„ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. </br>\nì €ëŠ” ì´ ìŠ¬ë™ë´‡ì„ ì‘ë™ì‹œí‚¬ ëŒë‹¤ í•¨ìˆ˜ë¥¼ SAM ì„ ì´ìš©í•˜ì—¬ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.</br></p>\n<p>AWS CloudFormation template ì˜ í™•ì¥ ê¸°ëŠ¥ì…ë‹ˆë‹¤. SAM template ë°°í¬ ê³¼ì •ì—ì„œ CloudFormation template êµ¬ë¬¸ìœ¼ë¡œ ì¬í•´ì„ë˜ì–´ ë°°í¬ëœë‹¤ê³  í•©ë‹ˆë‹¤.</p>\n<blockquote>\n<p>CloudFormation? AWS ë¦¬ì†ŒìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ì£¼ëŠ” ì„œë¹„ìŠ¤.</p>\n</blockquote>\n<p>SAMìœ¼ë¡œ êµ¬ì¶•ê°€ëŠ¥í•œ AWS ì„œë¹„ìŠ¤ì˜ ì¢…ë¥˜ëŠ” ì•„ë˜ì™€ ê°™ì•„ìš”.</p>\n<ul>\n<li>Lambda</li>\n<li>API Gateway</li>\n<li>DynamoDB</li>\n</ul>\n<p><code class=\"language-text\">SAM CLI</code>ë¥¼ í†µí•´ local í™˜ê²½ì—ì„œì˜ ê°œë°œ ë° í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>\n<blockquote>\n<p>SAM CLI? SAM ê¸°ë°˜ application êµ¬ì¶•ì„ ì§€ì›í•˜ëŠ” ëª…ë ¹ì¤„ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤.</p>\n</blockquote>\n<p><a href=\"https://docs.aws.amazon.com/ko_kr/serverless-application-model/latest/developerguide/install-sam-cli.html\">AWS SAM CLI ì„¤ì¹˜ ê³µì‹ë¬¸ì„œ</a> ğŸ‘ˆğŸ»</p>\n<h2 id=\"slack-event-subscriptions-ì—ì„œ-endpoint-ì¸ì¦\" style=\"position:relative;\"><a href=\"#slack-event-subscriptions-%EC%97%90%EC%84%9C-endpoint-%EC%9D%B8%EC%A6%9D\" aria-label=\"slack event subscriptions ì—ì„œ endpoint ì¸ì¦ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Slack] Event Subscriptions ì—ì„œ Endpoint ì¸ì¦</h2>\n<p>ì•„ë˜ëŠ” Request URL ì¸ì¦ ì „ì— ì„ í–‰ë˜ì–´ì•¼ í•˜ëŠ” ì‘ì—…ë“¤ì…ë‹ˆë‹¤.</p>\n<ol>\n<li><a href=\"https://api.slack.com/\">slack api</a> ì—ì„œ ì•± ìƒì„±</li>\n<li><code class=\"language-text\">OAuth &amp; Permissions</code> ì—ì„œ ê¶Œí•œ ì„¤ì •ì„ í•˜ê±°ë‚˜ </br>\nì•„ë˜ ì´ë¯¸ì§€ë¥¼ ì°¸ê³ í•˜ì—¬ <code class=\"language-text\">App Manifest</code> ì— ì¶”ê°€í•´ì¤˜ë„ ì¢‹ìŠµë‹ˆë‹¤.</li>\n</ol>\n<p>Â Â Â Â Â Â Â Â Â Â Â Â Â \n<img width=\"400\" alt=\"&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2023-01-24 &#x110B;&#x1169;&#x1112;&#x116E; 5 49 57\" src=\"https://user-images.githubusercontent.com/28856435/214248252-58167532-1dc9-4ab7-b02d-b3b9b0796123.png\"></p>\n<ul>\n<li>Lambda í•¨ìˆ˜ ìƒì„±, AWS Gateway ì¶”ê°€</li>\n</ul>\n</br>\n<ol start=\"3\">\n<li>Request URL ì¸ì¦ </br>\n<code class=\"language-text\">Event Subscription</code>ì— ì´ë¯¸ì§€ ë‹¤ìš´/ì—…ë¡œë“œ ê¸°ëŠ¥ì´ êµ¬í˜„ëœ ëŒë‹¤ í•¨ìˆ˜ì˜ <code class=\"language-text\">API Gateway</code> ë¥¼\nì¸ì¦ì„ ì™„ë£Œí•´ì•¼ í•´ë‹¹ APIê°€ í˜¸ì¶œë©ë‹ˆë‹¤.\nì—¬ê¸°ì„œ ìš”êµ¬í•˜ëŠ” ì‘ë‹µ í˜•ì‹ì´ ìˆëŠ”ë°, request body ë¡œë¶€í„° ë°›ì€ <code class=\"language-text\">challenge</code> íŒŒë¼ë¯¸í„°ë¥¼ í¬í•¨í•˜ì—¬ ë¦¬í„´ í•´ì¤˜ì•¼\nì¸ì¦ì— ì„±ê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. </br>\nâœ… <a href=\"https://api.slack.com/events/url_verification\">ìŠ¬ë™ ì´ë²¤íŠ¸ íƒ€ì… url_verification ë¬¸ì„œ</a> ë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”.</li>\n</ol>\n<p>Â Â Â Â Â Â Â Â Â Â Â Â Â \n<img width=\"400\" alt=\"&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2023-01-24 &#x110B;&#x1169;&#x1112;&#x116E; 6 02 38\" src=\"https://user-images.githubusercontent.com/28856435/214250768-0fffa2c5-1ae6-4a07-af80-352238cd0bcd.png\"></p>\n<p>pythonìœ¼ë¡œ êµ¬í˜„í•œ ì˜ˆì‹œ ì½”ë“œì…ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">verify_url</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># challenge íŒŒë¼ë¯¸í„°ê°€ ìˆì„ ë•Œ ì‘ë‹µê°’ì— í¬í•¨í•˜ì—¬ ë¦¬í„´</span>\n    <span class=\"token keyword\">if</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"challenge\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'body'</span><span class=\"token punctuation\">:</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"challenge\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">lambda_handler</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    logger<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Received event:\\n</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>event<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n    req_body <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"body\"</span><span class=\"token punctuation\">)</span>\n    event_type <span class=\"token operator\">=</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> event_type <span class=\"token operator\">==</span> <span class=\"token string\">'url_verification'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> verify_url<span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"slack-íŒŒì¼-ì—…ë¡œë“œ-ì´ë²¤íŠ¸-s3ì—-ì—…ë¡œë“œí•˜ê¸°\" style=\"position:relative;\"><a href=\"#slack-%ED%8C%8C%EC%9D%BC-%EC%97%85%EB%A1%9C%EB%93%9C-%EC%9D%B4%EB%B2%A4%ED%8A%B8-s3%EC%97%90-%EC%97%85%EB%A1%9C%EB%93%9C%ED%95%98%EA%B8%B0\" aria-label=\"slack íŒŒì¼ ì—…ë¡œë“œ ì´ë²¤íŠ¸ s3ì— ì—…ë¡œë“œí•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>[Slack] íŒŒì¼ ì—…ë¡œë“œ ì´ë²¤íŠ¸, S3ì— ì—…ë¡œë“œí•˜ê¸°</h2>\n<h3 id=\"main-fucntion\" style=\"position:relative;\"><a href=\"#main-fucntion\" aria-label=\"main fucntion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>main fucntion</h3>\n<p>íŒŒì¼ì´ë‚˜ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œ í–ˆì„ ë•Œì˜ ì´ë²¤íŠ¸ íƒ€ì… (request body.type) ì€ <code class=\"language-text\">event_callback</code> ì…ë‹ˆë‹¤.\nlambda_handlerì—ì„œ ì´ë²¤íŠ¸ì— ë”°ë¼ ê¸°ëŠ¥ì´ ìˆ˜í–‰ë˜ë„ë¡ í–ˆì–´ìš”.</p>\n<blockquote>\n<p>ì‚¬ìš©ëœ slack event types</p>\n<ul>\n<li>url_verification : Request URL ì¸ì¦</li>\n<li>event_callback : íŒŒì¼, ì´ë¯¸ì§€ ì—…ë¡œë“œ</li>\n<li>block_actions : ë²„íŠ¼ í´ë¦­</li>\n</ul>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">lambda_handler</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    logger<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Received event:\\n</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>event<span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span>\n    req_header <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'headers'</span><span class=\"token punctuation\">)</span>\n    req_body <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"body\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> req_header<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'X-Slack-Retry-Num'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        logger<span class=\"token punctuation\">.</span>info<span class=\"token punctuation\">(</span><span class=\"token string\">'The event already processed'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> make_response<span class=\"token punctuation\">(</span><span class=\"token string\">'OK'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'X-Slack-No-Retry'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    body <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>req_body<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'token'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> VERIFICATION_TOKEN<span class=\"token punctuation\">:</span>\n        logger<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">(</span><span class=\"token string\">'Unauthorized token.'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> make_response<span class=\"token punctuation\">(</span><span class=\"token string\">'Unauthorized token'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">401</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'X-Slack-No-Retry'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># ì´ë²¤íŠ¸ íƒ€ì…ë³„ ì²˜ë¦¬</span>\n    event_type <span class=\"token operator\">=</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> event_type <span class=\"token operator\">==</span> <span class=\"token string\">'url_verification'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> verify_url<span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">elif</span> event_type <span class=\"token operator\">==</span> <span class=\"token string\">'event_callback'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> upload_image<span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span> <span class=\"token comment\"># ì´ë¯¸ì§€ ì—…ë¡œë“œ</span>\n    <span class=\"token keyword\">elif</span> event_type <span class=\"token operator\">==</span> <span class=\"token string\">'block_actions'</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> add_tags<span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span> <span class=\"token comment\"># ë²„íŠ¼ í´ë¦­ì‹œ íƒœê·¸ì¶”ê°€</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        logger<span class=\"token punctuation\">.</span>warn<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'The event handler not found.: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>event_type<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> make_response<span class=\"token punctuation\">(</span><span class=\"token string\">'The event handler not found.'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'X-Slack-No-Retry'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"upload_image-í•¨ìˆ˜ì—ì„œ-í•˜ëŠ”ì¼\" style=\"position:relative;\"><a href=\"#upload_image-%ED%95%A8%EC%88%98%EC%97%90%EC%84%9C-%ED%95%98%EB%8A%94%EC%9D%BC\" aria-label=\"upload_image í•¨ìˆ˜ì—ì„œ í•˜ëŠ”ì¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>upload_image í•¨ìˆ˜ì—ì„œ í•˜ëŠ”ì¼</h3>\n<ul>\n<li><code class=\"language-text\">event</code> í•„ë“œì—ì„œ íŒŒì¼ object ë“¤ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.</li>\n<li>íŒŒì¼ì´ ìŠ¬ë™ë´‡ê³¼ ê³µìœ ë˜ê¸° ìœ„í•´ì„œëŠ” <code class=\"language-text\">files_sharedPublicURL()</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>\n<li>ì´ë¯¸ì§€ í™•ì¥ìë„ í™•ì¸ í›„,</li>\n<li><code class=\"language-text\">permalink_public</code> í•„ë“œ ì£¼ì†Œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. </br></li>\n<li>tmpì— ì´ë¯¸ì§€ ì €ì¥: urllib.reqeust.urlretrieve(â€œì´ë¯¸ì§€ ì£¼ì†Œâ€, â€œì €ì¥ í•  íŒŒì¼ì´ë¦„â€) </br></li>\n<li>S3ì— ì—…ë¡œë“œë¥¼ ìˆ˜í–‰í•˜ê³ ,</li>\n<li>ë§ˆì§€ë§‰ìœ¼ë¡œ ìŠ¤ë ˆë“œì— ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ íƒœê·¸ ë§Œë“¤ì–´ ë‚¨ê²¨ì£¼ë„ë¡ í–ˆìŠµë‹ˆë‹¤.</li>\n</ul>\n</br>\n<details>\n<summary style=\"cursor: pointer; color: #999\">â–º [OPEN!] upload_image í•¨ìˆ˜ í™•ì¸í•˜ê¸°</summary>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">upload_image</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    slack_event <span class=\"token operator\">=</span> body<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'event'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> slack_event<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'files'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        client<span class=\"token punctuation\">.</span>chat_postMessage<span class=\"token punctuation\">(</span>channel<span class=\"token operator\">=</span>slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'channel'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> thread_ts<span class=\"token operator\">=</span>slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'ts'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token string\">'ì—…ë¡œë“œ ìš”ì²­ì¤‘ì…ë‹ˆë‹¤. ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”! :meow_noddies:'</span><span class=\"token punctuation\">)</span>\n        files <span class=\"token operator\">=</span> slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'files'</span><span class=\"token punctuation\">]</span>\n        file_arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token keyword\">for</span> <span class=\"token builtin\">file</span> <span class=\"token keyword\">in</span> files<span class=\"token punctuation\">:</span>\n            _file <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                <span class=\"token comment\"># íŒŒì¼ì„ botê³¼ ê³µìœ </span>\n                client<span class=\"token punctuation\">.</span>files_sharedPublicURL<span class=\"token punctuation\">(</span>token<span class=\"token operator\">=</span>SLACK_USER_TOKEN<span class=\"token punctuation\">,</span> <span class=\"token builtin\">file</span><span class=\"token operator\">=</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> channels<span class=\"token operator\">=</span>CHANNEL_ID<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n                logger<span class=\"token punctuation\">.</span>warn<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'Failed to share file publicly: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">pass</span>\n\n            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                local_file_name <span class=\"token operator\">=</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">]</span>\n                local_file_path <span class=\"token operator\">=</span> tmp_path <span class=\"token operator\">+</span> local_file_name\n                <span class=\"token comment\"># ì´ë¯¸ì§€ í™•ì¥ì í™•ì¸</span>\n                plain_name<span class=\"token punctuation\">,</span> ext <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>splitext<span class=\"token punctuation\">(</span>local_file_name<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">if</span> ext <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'.jpg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.jpeg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.png'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.gif'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">raise</span> Exception<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'Invalid extension.: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>ext<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n\n                download_url <span class=\"token operator\">=</span> get_image_url<span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 'permalink_public' ì£¼ì†Œë¥¼ ê°€ì ¸ì˜´</span>\n                <span class=\"token comment\"># tmpì— ì´ë¯¸ì§€ ì €ì¥ : urllib.reqeust.urlretrieve(\"ì´ë¯¸ì§€ ì£¼ì†Œ\", \"ì €ì¥ í•  íŒŒì¼ì´ë¦„\")</span>\n                urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlretrieve<span class=\"token punctuation\">(</span>download_url<span class=\"token punctuation\">,</span> local_file_path<span class=\"token punctuation\">)</span>\n                file_name <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>uuid<span class=\"token punctuation\">.</span>uuid4<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span>\n\n                <span class=\"token comment\"># S3 ì—…ë¡œë“œ</span>\n                upload_S3_bucket<span class=\"token punctuation\">(</span>local_file_name<span class=\"token punctuation\">,</span> file_name<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n                logger<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>local_file_name<span class=\"token punctuation\">}</span></span><span class=\"token string\"> fail to uploading.: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">continue</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                _file <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">'width'</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">[</span><span class=\"token string\">'original_w'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'height'</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">[</span><span class=\"token string\">'original_h'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> file_name<span class=\"token punctuation\">,</span> <span class=\"token string\">'origin_name'</span><span class=\"token punctuation\">:</span> local_file_name <span class=\"token punctuation\">}</span>\n                file_arr<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>_file<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>file_arr<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">for</span> <span class=\"token builtin\">file</span> <span class=\"token keyword\">in</span> file_arr<span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                    client<span class=\"token punctuation\">.</span>chat_postMessage<span class=\"token punctuation\">(</span>channel<span class=\"token operator\">=</span>slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'channel'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> thread_ts<span class=\"token operator\">=</span>slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'ts'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> blocks<span class=\"token operator\">=</span>response_blocks<span class=\"token punctuation\">(</span><span class=\"token builtin\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n                    logger<span class=\"token punctuation\">.</span>error<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>local_file_name<span class=\"token punctuation\">}</span></span><span class=\"token string\"> fail to uploading.: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n                    client<span class=\"token punctuation\">.</span>chat_postMessage<span class=\"token punctuation\">(</span>channel<span class=\"token operator\">=</span>slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'channel'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> thread_ts<span class=\"token operator\">=</span>slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'ts'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token string\">'ì—…ë¡œë“œ ì‹¤íŒ¨ :smiling_face_with_tear:'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            client<span class=\"token punctuation\">.</span>chat_postMessage<span class=\"token punctuation\">(</span>channel<span class=\"token operator\">=</span>slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'channel'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> thread_ts<span class=\"token operator\">=</span>slack_event<span class=\"token punctuation\">[</span><span class=\"token string\">'ts'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token string\">'ì—…ë¡œë“œëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. :smiling_face_with_tear:'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> make_response<span class=\"token punctuation\">(</span><span class=\"token string\">'OK'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'X-Slack-No-Retry'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n</details>\n</br>\n<hr>\n</br>\n</br>\n</br>\n</br>\n<p>ê¸´ ê¸€ ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ ëŒ“ê¸€ì„ ë‚¨ê²¨ì£¼ì„¸ìš” ğŸ˜„</p>\n<blockquote>\n<p>ì „ì²´ ì½”ë“œëŠ” <a href=\"https://github.com/syankkim/image_upload_bot\">image-upload-bot</a> ë ˆí¬ì§€í† ë¦¬ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>\n</blockquote>","frontmatter":{"title":"[ìŠ¬ë™ë´‡ ë§Œë“¤ê¸°] Image upload to S3 using Lambda","date":"January 24, 2023"}}},"pageContext":{"slug":"/aws/ì´ë¯¸ì§€ì—…ë¡œë“œ_ìŠ¬ë™ë´‡/","previous":{"fields":{"slug":"/OS/ìš´ì˜ì²´ì œ-ê¸°ëŠ¥ëª©ì êµ¬ì¡°/"},"frontmatter":{"title":"âš™ï¸ [ìš´ì˜ì²´ì œ] ê¸°ëŠ¥,ëª©ì ,êµ¬ì¡°"}},"next":null}}}